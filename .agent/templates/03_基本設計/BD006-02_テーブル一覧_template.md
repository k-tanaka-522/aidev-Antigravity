# テーブル一覧

## ドキュメント情報

| 項目 | 内容 |
|------|------|
| ドキュメントID | BD006-02 |
| ドキュメント名 | テーブル一覧 |
| システム名 | {システム名} |
| サブシステム名 | {サブシステム名} |
| 版数 | {版数} |
| ステータス | {作成中/レビュー中/承認済み} |
| 作成日 | {YYYY/MM/DD} |
| 作成者 | {作成者名} |
| 承認日 | {YYYY/MM/DD} |
| 承認者 | {承認者名} |

## 変更履歴

| 版数 | 変更日 | 変更者 | 変更内容 | 承認者 |
|------|--------|--------|----------|--------|
| 1.0 | {YYYY/MM/DD} | {変更者名} | 新規作成 | {承認者名} |
| {版数} | {YYYY/MM/DD} | {変更者名} | {変更内容} | {承認者名} |

## 目次

1. [概要](#概要)
2. [テーブル一覧](#テーブル一覧)
3. [テーブル分類](#テーブル分類)
4. [データ量見積](#データ量見積)

---

## 概要

### 目的

{このテーブル一覧の目的を記述}

### 適用範囲

{このテーブル一覧が適用される範囲を記述}

### データベース環境

| 項目 | 内容 |
|------|------|
| DBMS | {PostgreSQL/MySQL/Oracle/SQL Server} |
| バージョン | {バージョン} |
| 文字コード | {UTF-8/UTF8MB4} |
| 照合順序 | {照合順序} |
| タイムゾーン | {UTC/Asia/Tokyo} |
| データベース名 | {データベース名} |
| スキーマ名 | {スキーマ名} |

---

## テーブル一覧

### 全テーブル一覧

| No | テーブルID | テーブル論理名 | テーブル物理名 | テーブル種別 | レコード数見積 | 成長率 | バックアップ | 備考 |
|----|-----------|---------------|---------------|-------------|---------------|--------|-------------|------|
| {No} | {T-XXX} | {論理名} | {physical_name} | {トランザクション/マスタ/履歴/ログ} | {件数} | {件/年} | {日次/週次/月次} | {備考} |
| 1 | T-001 | ユーザー | users | トランザクション | 10,000 | 1,000件/年 | 日次 | |
| 2 | T-002 | ロール | roles | マスタ | 10 | 1件/年 | 週次 | |
| 3 | T-003 | ユーザーロール | user_roles | トランザクション | 10,000 | 1,000件/年 | 日次 | |
| 4 | T-004 | 権限 | permissions | マスタ | 100 | 10件/年 | 週次 | |
| 5 | T-005 | ロール権限 | role_permissions | トランザクション | 500 | 50件/年 | 日次 | |
| 6 | T-006 | ユーザーセッション | user_sessions | トランザクション | 5,000 | - | なし | 30日で削除 |
| 7 | T-007 | パスワードリセットトークン | password_reset_tokens | トランザクション | 100 | - | なし | 24時間で削除 |
| 8 | T-010 | カテゴリ | categories | マスタ | 100 | 10件/年 | 週次 | |
| 9 | T-011 | 商品 | products | トランザクション | 10,000 | 1,000件/年 | 日次 | |
| 10 | T-012 | 商品画像 | product_images | トランザクション | 30,000 | 3,000件/年 | 日次 | |
| 11 | T-013 | 在庫 | inventory | トランザクション | 10,000 | 1,000件/年 | 日次 | |
| 12 | T-014 | 在庫履歴 | inventory_history | 履歴 | 500,000 | 100,000件/年 | 週次 | パーティション |
| 13 | T-020 | 顧客 | customers | トランザクション | 50,000 | 5,000件/年 | 日次 | |
| 14 | T-021 | 顧客住所 | customer_addresses | トランザクション | 100,000 | 10,000件/年 | 日次 | |
| 15 | T-030 | 注文 | orders | トランザクション | 100,000 | 50,000件/年 | 日次 | パーティション |
| 16 | T-031 | 注文明細 | order_details | トランザクション | 300,000 | 150,000件/年 | 日次 | パーティション |
| 17 | T-032 | 注文配送 | order_shipping | トランザクション | 100,000 | 50,000件/年 | 日次 | パーティション |
| 18 | T-033 | 注文決済 | order_payment | トランザクション | 100,000 | 50,000件/年 | 日次 | パーティション |
| 19 | T-034 | 注文ステータス履歴 | order_status_history | 履歴 | 500,000 | 250,000件/年 | 週次 | パーティション |
| 20 | T-040 | 支払方法 | payment_methods | マスタ | 10 | 1件/年 | 週次 | |
| 21 | T-041 | 配送方法 | shipping_methods | マスタ | 10 | 1件/年 | 週次 | |
| 22 | T-050 | カート | carts | トランザクション | 10,000 | - | なし | 30日で削除 |
| 23 | T-051 | カート明細 | cart_items | トランザクション | 50,000 | - | なし | 30日で削除 |
| 24 | T-060 | お気に入り | favorites | トランザクション | 200,000 | 50,000件/年 | 週次 | |
| 25 | T-070 | レビュー | reviews | トランザクション | 50,000 | 10,000件/年 | 週次 | |
| 26 | T-080 | クーポン | coupons | マスタ | 100 | 50件/年 | 週次 | |
| 27 | T-081 | クーポン使用履歴 | coupon_usage | 履歴 | 100,000 | 50,000件/年 | 週次 | |
| 28 | T-090 | 通知 | notifications | トランザクション | 500,000 | 250,000件/年 | 週次 | パーティション |
| 29 | T-100 | 監査ログ | audit_logs | ログ | 1,000,000 | 500,000件/年 | 月次 | パーティション |
| 30 | T-101 | エラーログ | error_logs | ログ | 100,000 | 50,000件/年 | 月次 | パーティション |

---

## テーブル分類

### テーブル種別説明

| テーブル種別 | 説明 | 特徴 | 例 |
|-------------|------|------|-----|
| マスタ | システム基礎データを格納 | 更新頻度が低い、参照が多い | カテゴリ、ロール、支払方法 |
| トランザクション | 業務データを格納 | 頻繁に更新・参照される | 注文、商品、顧客 |
| 履歴 | 変更履歴を記録 | 追記のみ、削除なし | 注文ステータス履歴、在庫履歴 |
| ログ | システムログを記録 | 追記のみ、保存期間あり | 監査ログ、エラーログ |

### ドメイン別テーブル分類

#### ユーザー・認証ドメイン

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 1 | T-001 | ユーザー | users | 10,000 |
| 2 | T-002 | ロール | roles | 10 |
| 3 | T-003 | ユーザーロール | user_roles | 10,000 |
| 4 | T-004 | 権限 | permissions | 100 |
| 5 | T-005 | ロール権限 | role_permissions | 500 |
| 6 | T-006 | ユーザーセッション | user_sessions | 5,000 |
| 7 | T-007 | パスワードリセットトークン | password_reset_tokens | 100 |

#### 商品ドメイン

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 8 | T-010 | カテゴリ | categories | 100 |
| 9 | T-011 | 商品 | products | 10,000 |
| 10 | T-012 | 商品画像 | product_images | 30,000 |
| 11 | T-013 | 在庫 | inventory | 10,000 |
| 12 | T-014 | 在庫履歴 | inventory_history | 500,000 |

#### 顧客ドメイン

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 13 | T-020 | 顧客 | customers | 50,000 |
| 14 | T-021 | 顧客住所 | customer_addresses | 100,000 |

#### 注文ドメイン

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 15 | T-030 | 注文 | orders | 100,000 |
| 16 | T-031 | 注文明細 | order_details | 300,000 |
| 17 | T-032 | 注文配送 | order_shipping | 100,000 |
| 18 | T-033 | 注文決済 | order_payment | 100,000 |
| 19 | T-034 | 注文ステータス履歴 | order_status_history | 500,000 |

#### マスタドメイン

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 20 | T-040 | 支払方法 | payment_methods | 10 |
| 21 | T-041 | 配送方法 | shipping_methods | 10 |
| 26 | T-080 | クーポン | coupons | 100 |

#### その他機能

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 22 | T-050 | カート | carts | 10,000 |
| 23 | T-051 | カート明細 | cart_items | 50,000 |
| 24 | T-060 | お気に入り | favorites | 200,000 |
| 25 | T-070 | レビュー | reviews | 50,000 |
| 27 | T-081 | クーポン使用履歴 | coupon_usage | 100,000 |
| 28 | T-090 | 通知 | notifications | 500,000 |

#### システム・ログ

| No | テーブルID | テーブル論理名 | テーブル物理名 | レコード数見積 |
|----|-----------|---------------|---------------|---------------|
| 29 | T-100 | 監査ログ | audit_logs | 1,000,000 |
| 30 | T-101 | エラーログ | error_logs | 100,000 |

---

## データ量見積

### レコード数見積（3年後）

| テーブル物理名 | 初期 | 1年後 | 2年後 | 3年後 | 増加率 | パーティション |
|---------------|------|-------|-------|-------|--------|---------------|
| users | 1,000 | 11,000 | 21,000 | 31,000 | 10,000件/年 | 不要 |
| products | 1,000 | 11,000 | 21,000 | 31,000 | 10,000件/年 | 不要 |
| customers | 5,000 | 55,000 | 105,000 | 155,000 | 50,000件/年 | 不要 |
| orders | 0 | 50,000 | 100,000 | 150,000 | 50,000件/年 | 必要（年次） |
| order_details | 0 | 150,000 | 300,000 | 450,000 | 150,000件/年 | 必要（年次） |
| inventory_history | 0 | 100,000 | 200,000 | 300,000 | 100,000件/年 | 必要（月次） |
| audit_logs | 0 | 500,000 | 1,000,000 | 1,500,000 | 500,000件/年 | 必要（月次） |

### ストレージ容量見積

| テーブル物理名 | 平均行サイズ | 3年後レコード数 | 見積容量 | 備考 |
|---------------|-------------|----------------|---------|------|
| users | 500 bytes | 31,000 | 15 MB | |
| products | 1 KB | 31,000 | 31 MB | |
| product_images | 200 bytes | 93,000 | 18 MB | 画像本体は別ストレージ |
| customers | 500 bytes | 155,000 | 77 MB | |
| customer_addresses | 300 bytes | 310,000 | 93 MB | |
| orders | 500 bytes | 150,000 | 75 MB | |
| order_details | 300 bytes | 450,000 | 135 MB | |
| order_shipping | 400 bytes | 150,000 | 60 MB | |
| order_payment | 400 bytes | 150,000 | 60 MB | |
| inventory_history | 200 bytes | 300,000 | 60 MB | |
| audit_logs | 500 bytes | 1,500,000 | 750 MB | |
| error_logs | 1 KB | 150,000 | 150 MB | |
| **合計** | | | **約1.5 GB** | インデックス含まず |

### パーティション設計

| テーブル物理名 | パーティション種別 | パーティションキー | パーティション単位 | 保持期間 |
|---------------|-------------------|-------------------|-------------------|----------|
| orders | 範囲パーティション | order_date | 年次 | 7年 |
| order_details | 範囲パーティション | created_at | 年次 | 7年 |
| order_shipping | 範囲パーティション | created_at | 年次 | 7年 |
| order_payment | 範囲パーティション | created_at | 年次 | 7年 |
| order_status_history | 範囲パーティション | created_at | 年次 | 7年 |
| inventory_history | 範囲パーティション | created_at | 月次 | 3年 |
| notifications | 範囲パーティション | created_at | 月次 | 1年 |
| audit_logs | 範囲パーティション | created_at | 月次 | 7年 |
| error_logs | 範囲パーティション | created_at | 月次 | 1年 |

### データ削除ポリシー

| テーブル物理名 | 削除ポリシー | 削除タイミング | 備考 |
|---------------|-------------|----------------|------|
| user_sessions | 有効期限切れセッション削除 | 日次バッチ | expires_at < 現在日時 |
| password_reset_tokens | 24時間経過したトークン削除 | 日次バッチ | created_at < 現在日時 - 1日 |
| carts | 30日間更新のないカート削除 | 日次バッチ | updated_at < 現在日時 - 30日 |
| cart_items | 親カート削除時に削除 | カスケード削除 | |
| notifications | 読了から90日経過した通知削除 | 週次バッチ | read_at < 現在日時 - 90日 |
| error_logs | 1年経過したログ削除 | 月次バッチ | パーティション削除 |

### インデックス設計方針

| テーブル種別 | インデックス設計方針 |
|-------------|---------------------|
| マスタ | 主キー、ユニークキー、検索用複合インデックス |
| トランザクション | 主キー、外部キー、日付範囲検索用インデックス、ステータス検索用インデックス |
| 履歴 | 主キー、外部キー、日付範囲検索用インデックス（パーティションキー含む） |
| ログ | 主キー、日付範囲検索用インデックス（パーティションキー含む） |

---

## 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| 作成者 | {作成者名} | {YYYY/MM/DD} | |
| レビュー担当者 | {レビュー担当者名} | {YYYY/MM/DD} | |
| 承認者 | {承認者名} | {YYYY/MM/DD} | |

---

## 参照

### 関連ドキュメント

- [ER図] BD006-01_ER図
- [テーブル定義書] BD006-03_テーブル定義書
- [機能設計書] BD002_機能設計書

### 外部参照

- {参照先タイトル}: {URL}
