# 監視設計書

## ドキュメント情報

| 項目 | 内容 |
|------|------|
| ドキュメントID | MT003-{YYYYMMDD} |
| プロジェクト名 | {プロジェクト名} |
| 作成日 | {YYYY/MM/DD} |
| 作成者 | {作成者名} |
| 版数 | {1.0} |
| 承認者 | {承認者名} |
| 承認日 | {YYYY/MM/DD} |

## 変更履歴

| 版数 | 日付 | 変更者 | 変更内容 |
|------|------|--------|----------|
| 1.0 | {YYYY/MM/DD} | {変更者名} | 新規作成 |

---

## 監視概要

### 監視方針

{監視方針を記述}

### 監視ツール

| ツール種別 | ツール名 | 用途 |
|------------|----------|------|
| インフラ監視 | {Prometheus/Zabbix/Datadog} | リソース監視 |
| APM | {New Relic/Dynatrace/AppDynamics} | アプリケーション監視 |
| ログ監視 | {ELK Stack/Splunk/Datadog Logs} | ログ収集・分析 |
| 外形監視 | {Pingdom/UptimeRobot/StatusCake} | 外部からの死活監視 |

---

## 監視項目

### インフラ監視

| 監視項目 | 監視対象 | 監視間隔 | 閾値(警告) | 閾値(異常) | 通知先 | 対応手順 |
|----------|----------|----------|------------|------------|--------|----------|
| CPU使用率 | Webサーバー | 5分 | 70% | 90% | 運用チーム | MT004参照 |
| メモリ使用率 | Webサーバー | 5分 | 80% | 95% | 運用チーム | MT004参照 |
| ディスク使用率 | DBサーバー | 10分 | 70% | 85% | 運用チーム | MT004参照 |
| ネットワーク帯域 | ロードバランサー | 5分 | 80% | 95% | 運用チーム | MT004参照 |

### アプリケーション監視

| 監視項目 | 監視対象 | 監視間隔 | 閾値(警告) | 閾値(異常) | 通知先 | 対応手順 |
|----------|----------|----------|------------|------------|--------|----------|
| レスポンスタイム | API | 1分 | 2秒 | 5秒 | 運用チーム | MT004参照 |
| エラー率 | API | 1分 | 1% | 5% | 運用チーム | MT004参照 |
| スループット | API | 5分 | 90% | 95% | 運用チーム | MT004参照 |
| プロセス数 | アプリ | 5分 | 8 | 10 | 運用チーム | MT004参照 |

### データベース監視

| 監視項目 | 監視対象 | 監視間隔 | 閾値(警告) | 閾値(異常) | 通知先 | 対応手順 |
|----------|----------|----------|------------|------------|--------|----------|
| 接続数 | PostgreSQL | 5分 | 80/100 | 95/100 | 運用チーム | MT004参照 |
| スロークエリ数 | PostgreSQL | 10分 | 10件/時間 | 50件/時間 | 開発チーム | MT004参照 |
| レプリケーション遅延 | PostgreSQL | 1分 | 60秒 | 300秒 | 運用チーム | MT004参照 |
| デッドロック | PostgreSQL | 5分 | 1件/日 | 10件/日 | 開発チーム | MT004参照 |

### 外形監視

| 監視項目 | 監視URL | 監視間隔 | 正常判定 | 通知先 | 対応手順 |
|----------|---------|----------|----------|--------|----------|
| サービス死活 | https://example.com | 1分 | HTTP 200 | 運用チーム | MT004参照 |
| ログインAPI | https://api.example.com/login | 5分 | HTTP 200, レスポンス2秒以内 | 運用チーム | MT004参照 |

---

## アラート設定

### アラート通知先

| 重要度 | 通知手段 | 通知先 |
|--------|----------|--------|
| 致命的 | 電話+メール+Slack | 運用責任者、運用リーダー |
| 重大 | メール+Slack | 運用チーム |
| 警告 | Slack | 運用チーム |
| 情報 | Slack | 運用チーム |

### アラート抑制

| 条件 | 抑制内容 | 理由 |
|------|----------|------|
| メンテナンス時間帯 | 全アラート抑制 | 計画停止 |
| デプロイ中 | 一時的なエラーアラート抑制 | デプロイ作業中 |

---

## ダッシュボード

### 監視ダッシュボード一覧

| ダッシュボード名 | 表示内容 | 更新間隔 | URL |
|------------------|----------|----------|-----|
| インフラ概要 | CPU/メモリ/ディスク | 1分 | {URL} |
| アプリケーション | レスポンスタイム/エラー率 | 1分 | {URL} |
| ビジネスメトリクス | ユーザー数/売上 | 5分 | {URL} |

---

## 承認記録

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| {作成者} | {氏名} | {YYYY/MM/DD} | {署名} |
| {承認者} | {氏名} | {YYYY/MM/DD} | {署名} |
